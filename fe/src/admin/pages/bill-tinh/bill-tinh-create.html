<div class="col-lg-12">
    <div class="table-wapper">
        <div class="table-title">
            <div class="row">
                <div class="col-sm-6 p-0 flex justify-content-lg-start justify-content-center">
                    <h2 class="ml-lg-2">Quản lý Hóa đơn</h2>
                </div>
                <div class="col-sm-6 p-0 flex justify-content-lg-end justify-content-center">
                    <a type="button" class="btn btn-success" ng-click="createBill()">
                        <i class="material-icons">&#xE147;</i>
                        <span>thêm hóa đơn</span>
                    </a>
                </div>
            </div>
        </div>
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th scope="col-1">STT</th>
                    <th scope="col-1">Mã</th>
                    <th scope="col-1">Tên Nhân viên</th>
                    <th scope="col-2">Ngày tạo</th>
                    <th scope="col-3">Khách hàng</th>
                    <th scope="col-2">loại hóa đơn</th>
                    <th scope="col-2">Trạng thái</th>
                    <th scope="col-2">action</th>
                </tr>
            </thead>

            <tbody>
                <tr ng-repeat="employee in bill">
                    <td scope="col-1" class="">
                        {{$index + 1}}
                    </td>
                    <td scope="col-1" class="css-text-overfolow">{{employee.code}}</td>
                    <td scope="col-1" class="css-text-overfolow">{{employee.employee.fullName}}</td>
                    <td scope="col-1" class="css-text-overfolow">{{employee.createdAt}}</td>
                    <td scope="col-1" class="css-text-overfolow">{{employee.customer.fullName}}</td>
                    <td scope="col-1" class="css-text-overfolow">{{employee.typeBill}}</td>
                    <td class="col-2" ng-switch="employee.status">
                        <span ng-switch-when="1">
                            <div class="badge bg-success text-wrap">
                                Nhân viên
                            </div>
                        </span>
                        <span ng-switch-when="2">
                            <div class="badge bg-danger text-wrap">
                                Khach hàng
                            </div>
                        </span>
                    </td>
                    <td scope="col-1">
                        <a type="button" class="edit" data-bs-toggle="modal" data-bs-target="#AuditLogUpdate"
                            ng-click="detailAuditLog(employee)">
                            <i class="material-icons" title="Detail">&#xE254;</i>
                        </a>
                        <a type="button" class="btn" data-bs-toggle="modal" data-bs-target=""
                            ng-click="delete(employee)">
                            <i class="material-icons" title="Delete">&#xE872;</i>
                        </a>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div><br><br>

<div>
    <form class="table-title" name="formProduct">
        <div class="row">
            <div class="col-sm-4 p-0 flex justify-content-lg-start justify-content-center">
                <h2 class="ml-lg-2">Thông tin sản phẩm</h2>
            </div>
            <div class="col-sm-6 p-0 flex justify-content-lg-start justify-content-center row">
                <div class="col-sm-4 p-0 flex justify-content-lg-start justify-content-center">
                    <h2 class="ml-lg-2">Thông tin sản phẩm</h2>
                </div>
                <div class="col-sm-4 p-0 flex justify-content-lg-start justify-content-center">
                    <h2 class="ml-lg-2">Thông tin sản phẩm</h2>
                </div>
            </div>
            <div class="col-sm-2 p-0 flex justify-content-lg-end justify-content-center">
                <a type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#modalAddProduct">
                    <i class="material-icons">&#xE147;</i>
                    <span>Chọn sản phẩm </span>
                </a>
            </div>
        </div>

    </form>
</div>
<div class="modal fade" tabindex="-1" id="modalAddProduct" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">

            <div class="modal-header">
                <h5 class="modal-title">Sản phẩm</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div>
                <form ng-submit="applyFilters()">
                    <div class="row">
                        <div class="col-10">
                            <div class="row">
                                <div class="col-md-4">
                                    <label>Tên sản Phẩm:</label>
                                    <input type="text" ng-model="filters.name" placeholder="Nhập tên sản phẩm"
                                        class="form-control" />
                                </div>

                                <div class="col-md-4">
                                    <label>Giá:</label>
                                    <input type="text" class="form-control" ng-model="filters.price"
                                        placeholder="Nhập giá " />
                                </div>
                            </div>
                        </div>
                        <div class="col-2">
                            <div>
                                <button type="submit" class="btn btn-outline-primary mb-2 form-control">
                                    Tìm kiếm
                                </button>
                                <button type="button" class="btn btn-outline-info mb-2 form-control"
                                    ng-click="resetFilters()">
                                    Reset
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div>
                <table class="table table-striped table-hover">
                    <thead>
                        <tr>
                            <th scope="col-1">STT</th>
                            <th scope="col-1">Ảnh</th>
                            <th scope="col-3">Tên Sản phẩm</th>
                            <th scope="col-3">Số lượng</th>
                            <th scope="col-2">Giá</th>
                            <th scope="col-2">Thao tác</th>
                        </tr>
                    </thead>

                    <tbody>
                        <tr ng-repeat="employee in filterProductDetall">
                            <td scope="col-1" class="">
                                {{$index + 1}}
                            </td>
                            <td scope="col-1" class="css-text-overfolow">{{employee.product.image.name}}</td>
                            <td scope="col-3" class="css-text-overfolow">{{employee.product.name}}</td>
                            <td class="col-3">
                                <p><input type="number" class="form-control w-50" min="1"
                                        oninput="this.value = !!this.value && Math.abs(this.value) >= 1 ? Math.abs(this.value) : 1"
                                        ng-model="employee.inputQuantity" ng-change="validateQuantity(employee)"></p>
                                <!-- <p>Số lượng chọn: {{employee.inputQuantity}}</p> -->
                                <p>Còn lại: {{employee.remainingQuantity}}</p>
                            </td>

                            <!-- <td scope="col-1" class="css-text-overfolow">{{employee.quantity}}</td> -->
                            <td scope="col-2" class="css-text-overfolow">{{employee.product.price}}</td>
                            <td scope="col-2">
                                <but type="button" class="edit" data-bs-toggle="modal" data-bs-target="#AuditLogUpdate"
                                    ng-click="detailProductBill(employee)">Chọn
                                    </a>

                            </td>
                        </tr>
                    </tbody>
                </table>
                <div class="clearfix">
                    <ul class="pagination">
                        <div class="d-flex justify-content-between align-items-center">
                            <button class="btn btn-primary" ng-disabled="currentPage == 0"
                                ng-click="getProductDetall(currentPage - 1)">
                                Previous
                            </button>
                            <span class="ms-3 me-3">Page
                                <input type="number" class="form-control d-inline-block w-auto ms-2 me-2"
                                    ng-model="desiredPage" min="1" max="{{totalPages}}"
                                    ng-change="goToPageAuditlog()" />
                                of {{totalPages}}</span>
                            <button class="btn btn-primary" ng-disabled="currentPage == totalPages - 1"
                                ng-click="getProductDetall(currentPage + 1)">
                                Next
                            </button>
                        </div>
                    </ul>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    Đóng
                </button>
            </div>

        </div>
    </div>
</div>

<div ng-if="selectedProductDetails.length > 0">
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th scope="col-1">STT</th>
                <th scope="col-1">Ảnh</th>
                <th scope="col-1">Tên Sản phẩm</th>
                <th scope="col-2">Số lượng</th>
                <th scope="col-3">Giá</th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="productDetail in selectedProductDetails">
                <td scope="col-1">{{index +1}}</td>
                <td scope="col-1">{{productDetail.image}}</td>
                <td scope="col-1">{{productDetail.product.name}}</td>
                <!-- <td class="col-2">
                    <p><input type="number" class="form-control w-50" min="1"
                            oninput="this.value = !!this.value && Math.abs(this.value) >= 1 ? Math.abs(this.value) : 1"
                            ng-model="productDetail.inputQuantity" ng-change="validateQuantity(pd)"></p>
                    <p>Còn lại: {{productDetail.quantity}}</p>
                </td> -->
                <!-- <td><button class="btn btn-warning"
                        ng-click="addBillDetail(pd.id, pd.inputQuantity, pd.product.price, pd.product.price, pd)">Thêm</button>
                </td> -->
                <td scope="col-1">{{productDetail.quantity}}</td>
                <td scope="col-1">{{productDetail.product.price | currency}}</td>
                <td scope="col-1">
                    <button type="button" class="btn btn-danger" ng-click="removeProductDetail($index)">Xóa</button>
                </td>
            </tr>
        </tbody>
    </table>
</div>